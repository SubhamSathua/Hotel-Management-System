<div class="bookings-container">
  <!-- Header -->
  <div class="bookings-header">
    <div class="header-content">
      <h1 class="bookings-title">All Bookings</h1>
      <div class="pending-counter">
        <span class="pending-label">Pending:</span>
        <span class="pending-count">{{ getPendingCount() }}</span>
      </div>
    </div>
    <div class="header-actions">
      <button class="refresh-btn" (click)="refreshBookings()">
        <img src="ico/refresh-page-option.png" alt="Refresh" class="refresh-icon">
        Refresh
      </button>
      <button class="back-btn" (click)="goBack()">
        <img src="ico/home.png" alt="Back" class="back-icon">
        Back to Dashboard
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading bookings...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-container">
    <img src="ico/danger.png" alt="Error" class="error-icon">
    <h3>Error Loading Bookings</h3>
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="refreshBookings()">Try Again</button>
  </div>

  <!-- Bookings Table -->
  <div *ngIf="!loading && !error" class="bookings-content">
    <div class="bookings-summary">
      <h3>Total Bookings: {{ bookings.length }}</h3>
    </div>

    <div class="table-container" *ngIf="bookings.length > 0">
      <table class="bookings-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Check-in Date</th>
            <th>Check-out Date</th>
            <th>Guests</th>
            <th>Children</th>
            <th>Total Fee</th>
            <th>Status</th>
            <th>Room ID</th>
            <th>User ID</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let booking of bookings" class="booking-row">
            <td>{{ booking.id }}</td>
            <td>{{ booking.checkinDate }}</td>
            <td>{{ booking.checkoutDate }}</td>
            <td>{{ booking.totalNumOfGuest }}</td>
            <td>{{ booking.numOfChildren }}</td>
            <td class="fee">â‚¹{{ booking.totalFee }}</td>
            <td>
              <span class="status-badge" [ngClass]="'status-' + booking.status?.toLowerCase()">
                {{ booking.status }}
              </span>
            </td>
            <td>{{ booking.roomId }}</td>
            <td>{{ booking.userId }}</td>
            <td class="actions-cell">
              <div *ngIf="booking.status?.toLowerCase() === 'pending'" class="action-buttons">
                <button class="cancel-btn" (click)="cancelBooking(booking)">
                  Cancel
                </button>
                <button class="checkout-btn" (click)="checkoutBooking(booking)">
                  Check-Out
                </button>
              </div>
              <span *ngIf="booking.status?.toLowerCase() !== 'pending'" class="no-actions">
                -
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- No bookings state -->
    <div *ngIf="bookings.length === 0" class="no-bookings">
      <div class="no-bookings-icon">ðŸ“‹</div>
      <h3>No Bookings Found</h3>
      <p>There are currently no bookings in the system.</p>
    </div>
  </div>
</div>

<!-- OTP Modal -->
<div *ngIf="showOtpModal" class="otp-modal-overlay">
  <div class="otp-modal">
    <div class="otp-modal-header">
      <h3>Checkout Verification</h3>
      <button class="close-btn" (click)="closeOtpModal()">Ã—</button>
    </div>
    
    <div class="otp-modal-content">
      <p>Enter OTP to complete checkout for Booking ID: <strong>{{ currentBookingForCheckout?.id }}</strong></p>
      <p><small>Confirmation Code: {{ currentBookingForCheckout?.bookingConfirmationCode }}</small></p>
      
      <div class="otp-input-group">
        <label for="otpInput">Enter OTP:</label>
        <input 
          type="text" 
          id="otpInput"
          [(ngModel)]="otpInput" 
          placeholder="Enter OTP"
          class="otp-input">
      </div>
      
      <div class="otp-modal-actions">
        <button class="verify-btn" (click)="verifyOtpAndCheckout()">
          Verify & Checkout
        </button>
        <button class="cancel-otp-btn" (click)="closeOtpModal()">
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>